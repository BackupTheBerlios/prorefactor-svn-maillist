<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Prorefactor-svn] r43 - in trunk: org.prorefactor.core/src/org/prorefactor/treeparser01 org.prorefactor.doc org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/pub org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/rename/t01/orig org.prorefactor.refactor/src/org/prorefactor/refactor org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/prorefactor-svn/2006-February/index.html" >
   <LINK REL="made" HREF="mailto:prorefactor-svn%40lists.berlios.de?Subject=Re%3A%20%5BProrefactor-svn%5D%20r43%20-%20in%20trunk%3A%20org.prorefactor.core/src/org/prorefactor/treeparser01%20org.prorefactor.doc%20org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/pub%20org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/rename/t01/orig%20org.prorefactor.refactor/src/org/prorefactor/refactor%20org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames&In-Reply-To=%3C200602071758.k17HwVFg010570%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Prorefactor-svn] r43 - in trunk: org.prorefactor.core/src/org/prorefactor/treeparser01 org.prorefactor.doc org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/pub org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/rename/t01/orig org.prorefactor.refactor/src/org/prorefactor/refactor org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames</H1>
    <B>johnallengreen at BerliOS</B> 
    <A HREF="mailto:prorefactor-svn%40lists.berlios.de?Subject=Re%3A%20%5BProrefactor-svn%5D%20r43%20-%20in%20trunk%3A%20org.prorefactor.core/src/org/prorefactor/treeparser01%20org.prorefactor.doc%20org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/pub%20org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/rename/t01/orig%20org.prorefactor.refactor/src/org/prorefactor/refactor%20org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames&In-Reply-To=%3C200602071758.k17HwVFg010570%40sheep.berlios.de%3E"
       TITLE="[Prorefactor-svn] r43 - in trunk: org.prorefactor.core/src/org/prorefactor/treeparser01 org.prorefactor.doc org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/pub org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/rename/t01/orig org.prorefactor.refactor/src/org/prorefactor/refactor org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames">johnallengreen at berlios.de
       </A><BR>
    <I>Tue Feb  7 18:58:31 CET 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000037.html">[Prorefactor-svn] r44 - in trunk: . org.prolint.core org.prolint.core/META-INF org.prolint.core/src org.prolint.core/src/org org.prolint.core/src/org/prolint org.prolint.core/src/org/prolint/core org.prolint.core/src/org/prolint/eclipse org.prolint.core/src/org/prolint/rules org.prolint.core/src/org/prolint/unittest org.prolint.core/src/testdata org.prolint.core/src/testdata/abbrevnames org.prolint.core/src/testdata/junit_s2k org.prolint.core/src/testdata/simpleunit org.prorefactor.core org.prorefactor.core/META-INF org.prorefactor.doc org.prorefactor.doc/META-INF org.prorefactor.eclipse org.prorefactor.eclipse/META-INF org.prorefactor.eclipse/src/org/prorefactor/eclipse/actions org.prorefactor.eclipse/src/org/prorefactor/eclipse/wizards org.prorefactor.feature org.prorefactor.javadoc org.prorefactor.javadoc/META-INF org.prorefactor.lib org.prorefactor.lib/META-INF org.prorefactor.lib/antlr org.prorefactor.lib/junit org.prorefactor.refactor org.prorefactor.refactor/META-INF org.prore! factor.refactor/src/org/prorefactor/refactor org.prorefactor.refactor/src/org/prorefactor/refactor/util org.prorefactor.update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: johnallengreen
Date: 2006-02-07 18:58:12 +0100 (Tue, 07 Feb 2006)
New Revision: 43

Modified:
   trunk/org.prorefactor.core/src/org/prorefactor/treeparser01/TP01Support.java
   trunk/org.prorefactor.doc/manual.xml
   trunk/org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/pub/test01.p.pub
   trunk/org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/rename/t01/orig/t01.p.pub
   trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/PUB.java
   trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames/NamesLint.java
Log:
Fixed bug in tree parser. The &quot;storetype&quot; was not being set for field nodes. As a result, the &quot;table and field names&quot; refactoring was missing some changes, depending on which refactoring options were set.

Modified: trunk/org.prorefactor.core/src/org/prorefactor/treeparser01/TP01Support.java
===================================================================
--- trunk/org.prorefactor.core/src/org/prorefactor/treeparser01/TP01Support.java	2006-02-07 02:20:57 UTC (rev 42)
+++ trunk/org.prorefactor.core/src/org/prorefactor/treeparser01/TP01Support.java	2006-02-07 17:58:12 UTC (rev 43)
@@ -435,6 +435,7 @@
 		// Table field
 		if (result.field != null) {
 			refNode.setSymbol(result.field);
+			refNode.attrSet(IConstants.STORETYPE, result.field.getField().getTable().getStoretype());
 			result.field.noteReference(contextQualifier);
 		}
 

Modified: trunk/org.prorefactor.doc/manual.xml
===================================================================
--- trunk/org.prorefactor.doc/manual.xml	2006-02-07 02:20:57 UTC (rev 42)
+++ trunk/org.prorefactor.doc/manual.xml	2006-02-07 17:58:12 UTC (rev 43)
@@ -7,7 +7,7 @@
 
     &lt;date&gt;2006&lt;/date&gt;
 
-    &lt;pubdate&gt;January 2006, ProRefactor version 1.2.4&lt;/pubdate&gt;
+    &lt;pubdate&gt;February 2006, ProRefactor version 1.3.0&lt;/pubdate&gt;
 
     &lt;author&gt;
       &lt;firstname&gt;John&lt;/firstname&gt;
@@ -1564,12 +1564,15 @@
 
     &lt;variablelist&gt;
       &lt;varlistentry&gt;
-        &lt;term&gt;Version 1.2.4&lt;/term&gt;
+        &lt;term&gt;Version 1.3.0&lt;/term&gt;
 
         &lt;listitem&gt;
           &lt;itemizedlist&gt;
             &lt;listitem&gt;
-              &lt;para&gt;No feature enhancements - just internal changes.&lt;/para&gt;
+              &lt;para&gt;IMPORTANT: Added data-type to the schemadump programs. You
+              must re-dump your schema before using this version of
+              ProRefactor. Added data type attribute to fields and variables
+              in the symbol table.&lt;/para&gt;
             &lt;/listitem&gt;
 
             &lt;listitem&gt;
@@ -1584,13 +1587,6 @@
             &lt;/listitem&gt;
 
             &lt;listitem&gt;
-              &lt;para&gt;Added data-type to the schemadump programs. You must
-              re-dump your schema before using this version of ProRefactor.
-              Added data type attribute to fields and variables in the symbol
-              table.&lt;/para&gt;
-            &lt;/listitem&gt;
-
-            &lt;listitem&gt;
               &lt;para&gt;Some classes and class members have been deprecated, and
               will be removed soon. Please see the javadoc.&lt;/para&gt;
             &lt;/listitem&gt;
@@ -1602,10 +1598,23 @@
             &lt;/listitem&gt;
 
             &lt;listitem&gt;
-              &lt;para&gt;Field and variable names referenced by the INPUT function
-              are no longer refactored. This is a (hopefully temporary)
-              workaround for a recently found bug.&lt;/para&gt;
+              &lt;para&gt;Added support for frame scopes and the lookup of field
+              frames. This was a large task, requiring a lot of changes and
+              additions. With this, was able to fix a bug where the fields
+              referenced by the INPUT function were not being looked up
+              properly. They should have been looked up through the stack of
+              fields in frames, rather than through the usual field/variable
+              lookup methods. Thanks Bruce Craigie for the INPUT function bug
+              report.&lt;/para&gt;
             &lt;/listitem&gt;
+
+            &lt;listitem&gt;
+              &lt;para&gt;Fixed bug in tree parser. The &quot;storetype&quot; was not being
+              set for field nodes. As a result, the &quot;table and field names&quot;
+              refactoring was missing some changes, depending on which
+              refactoring options were set. Thanks Bruce Craigie for this bug
+              report.&lt;/para&gt;
+            &lt;/listitem&gt;
           &lt;/itemizedlist&gt;
         &lt;/listitem&gt;
       &lt;/varlistentry&gt;

Modified: trunk/org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/pub/test01.p.pub
===================================================================
(Binary files differ)

Modified: trunk/org.prorefactor.refactor/prorefactor/projects/sports2000/pubs/data/rename/t01/orig/t01.p.pub
===================================================================
(Binary files differ)

Modified: trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/PUB.java
===================================================================
--- trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/PUB.java	2006-02-07 02:20:57 UTC (rev 42)
+++ trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/PUB.java	2006-02-07 17:58:12 UTC (rev 43)
@@ -60,7 +60,7 @@
 		pubFile = new File(refpack.getProRefactorProjectDir() + &quot;/pubs/&quot; + relPath + &quot;.pub&quot;);
 	}
 	
-	public static final int LAYOUT_VERSION = 3;
+	public static final int LAYOUT_VERSION = 4;
 
 	/** loadTo(PUBFILE_TIMESTAMP) - just check if the binary exists and
 	 * check that it is newer than the compile unit file. Does not read anything

Modified: trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames/NamesLint.java
===================================================================
--- trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames/NamesLint.java	2006-02-07 02:20:57 UTC (rev 42)
+++ trunk/org.prorefactor.refactor/src/org/prorefactor/refactor/tfnames/NamesLint.java	2006-02-07 17:58:12 UTC (rev 43)
@@ -119,8 +119,8 @@
 		}
 
 		// Are we applying changes to work/temp tables?
-		if (	! settings.workTempTables
-			&amp;&amp;	node.attrGet(IConstants.STORETYPE) != IConstants.ST_DBTABLE
+		if (	(! settings.workTempTables)
+			&amp;&amp;	(node.attrGet(IConstants.STORETYPE) != IConstants.ST_DBTABLE)
 			) return;
 
 		currTarget.abbreviated = needsAbbrevFix(node);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000037.html">[Prorefactor-svn] r44 - in trunk: . org.prolint.core org.prolint.core/META-INF org.prolint.core/src org.prolint.core/src/org org.prolint.core/src/org/prolint org.prolint.core/src/org/prolint/core org.prolint.core/src/org/prolint/eclipse org.prolint.core/src/org/prolint/rules org.prolint.core/src/org/prolint/unittest org.prolint.core/src/testdata org.prolint.core/src/testdata/abbrevnames org.prolint.core/src/testdata/junit_s2k org.prolint.core/src/testdata/simpleunit org.prorefactor.core org.prorefactor.core/META-INF org.prorefactor.doc org.prorefactor.doc/META-INF org.prorefactor.eclipse org.prorefactor.eclipse/META-INF org.prorefactor.eclipse/src/org/prorefactor/eclipse/actions org.prorefactor.eclipse/src/org/prorefactor/eclipse/wizards org.prorefactor.feature org.prorefactor.javadoc org.prorefactor.javadoc/META-INF org.prorefactor.lib org.prorefactor.lib/META-INF org.prorefactor.lib/antlr org.prorefactor.lib/junit org.prorefactor.refactor org.prorefactor.refactor/META-INF org.prore! factor.refactor/src/org/prorefactor/refactor org.prorefactor.refactor/src/org/prorefactor/refactor/util org.prorefactor.update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/prorefactor-svn">More information about the Prorefactor-svn
mailing list</a><br>
</body></html>
